# SettingsStore

Библиотека для работы с настройками — сохранение/чтение настроек в/из flash

Микроконтроллеры серии CH32V003 не имеют на борту EEPROM, поэтому ее приходится
эмулировать с помощью flash.
Минусы такого подхода:

- отъедается и так небольшой размер памяти под программу.
- при обновлении прошивки все ранее сохраненные во flash данные будут потеряны.

Библиотека ориентирована на работу с пользовательскими настройками и конфигурационными
параметрами устройства и не предполагает активной перезаписи содержимого flash,
поэтому в ней не предусмотрен wear-leveling (хотя небольшую оптимизацию записи можно
подключить).
Если нужно писать часто, лучше использовать другую библиотеку, а еще лучше - внешнюю EPPROM.

Особенности:

- Данные размещаются от конца flash вниз.
- Используется Fast mode постраничный, поэтому сохраняемый размер округляется
  до значения, кратного размеру страницы (64 байта).
- Поддержка CRC16-CCITT (опционально). Использует последние 2 байта в структуре).
- Нет динамического выделения памяти.

Массив сохраняемых данных (может быть оформлен в виде структуры) должен иметь фиксированный размер.
Структура должна быть описана с __attribute__((packed)), если планируется использование CRC.
Место под хранение вычисляется автоматически по размеру структуры и кратно размеру страницы flash.

Если требуется высокая достоверность данных, можно подключить контроль данных с использованием CRC,
но использование CRC немного снижает скорость работы (+8 мксек на операцию чтения/сохранения).
